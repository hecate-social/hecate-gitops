[Unit]
Description=Hecate Trader Daemon (plugin)
After=hecate-daemon.service
Requires=hecate-daemon.service

[Container]
Image=ghcr.io/hecate-social/hecate-traderd:0.1.0
ContainerName=hecate-traderd
AutoUpdate=registry
Network=host

# Bind mount the plugin's data directory
Volume=%h/.hecate/hecate-traderd:/data:Z

# Also mount hecate-daemon socket dir (for registration)
Volume=%h/.hecate/hecate-daemon/sockets:/run/hecate-daemon:ro

# Environment from file
EnvironmentFile=%h/.hecate/gitops/apps/hecate-traderd.env

# Health check via socket presence
HealthCmd=test -S /data/sockets/api.sock
HealthInterval=30s
HealthRetries=3
HealthTimeout=5s
HealthStartPeriod=10s

[Service]
Restart=on-failure
RestartSec=5s
TimeoutStartSec=60s

[Install]
WantedBy=default.target
